<!DOCTYPE HTML>
<html lang="de">
<head>
<title>WinGet - Syntax &amp; Verwendung | AutoHotkey v1</title>
<meta name="description" content="Der WinGet-Befehl ruft die eindeutige ID, Prozess-ID oder den Prozessnamen eines bestimmten Fensters oder eine Liste seiner Steuerelemente ab." />
<meta name="ahk:equiv-v2" content="lib/Win.htm" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga4.js" type="text/javascript"></script>
</head>
<body>

<h1>WinGet</h1>

<p>Ruft die eindeutige ID, Prozess-ID oder den Prozessnamen eines bestimmten Fensters oder eine Liste seiner Steuerelemente ab. Kann auch eine Liste aller Fenster gemäß bestimmter Kriterien abrufen.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar <span class="optional">, <a href="#SubCommands">Unterbefehl</a>, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>

<h2 id="Parameters">Parameter</h2>
<dl>
  <dt>AusgabeVar</dt>
  <dd>Name der Ausgabevariable, in der das Ergebnis von <em>Unterbefehl</em> gespeichert werden soll.</dd>

  <dt>Unterbefehl</dt>
  <dd>Wenn leer oder weggelassen, wird standardmäßig <a href="#ID">ID</a> verwendet (die eindeutige ID eines Fensters abrufen). Andernfalls geben Sie den <a href="#SubCommands">Unterbefehl</a> an, der ausgeführt werden soll.</dd>

  <dt>FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</dt>
  <dd>
    <p>Wenn jeder dieser Parameter leer ist oder weggelassen wird, wird das <a href="../misc/WinTitle.htm#LastFoundWindow">Zuletzt Gefundene Fenster</a> verwendet (außer bei den Unterbefehlen <a href="#Count">Count</a> und <a href="#List">List</a>). Andernfalls geben Sie für <em>FensterTitel</em> einen <a href="../misc/WinTitle.htm">Fenstertitel oder andere Kriterien</a> zur Identifizierung des Zielfensters und/oder für <em>FensterText</em> eine Teilzeichenkette aus einem Textelement des Zielfensters an (Textelemente können mit dem internen Tool "Window Spy" in Erfahrung gebracht werden).</p>
    <p><em>AusnahmeTitel</em> und <em>AusnahmeText</em> können verwendet werden, um ein oder mehrere Fenster anhand ihres Titels oder Textes auszuschließen. Ihre Angabe ähnelt der von <em>FensterTitel</em> und <em>FensterText</em>, außer dass <em>AusnahmeTitel</em> keine anderen Kriterien als den Fenstertitel erkennt.</p>
    <p>Fenstertitel und -texte sind Groß-/Kleinschreibung-sensitiv. Standardmäßig werden versteckte Fenster nicht erkannt und versteckte Textelemente erkannt, was mit <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> und <a href="DetectHiddenText.htm">DetectHiddenText</a> geändert werden kann. Standardmäßig muss ein Fenstertitel mit dem angegebenen <em>FensterTitel</em> oder <em>AusnahmeTitel</em> beginnen, um eine Übereinstimmung zu sein, was mit <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a> geändert werden kann.</p>
  </dd>
</dl>

<h2 id="SubCommands">Unterbefehle</h2>
<p>Geben Sie für <em>Unterbefehl</em> Folgendes an:</p>
<ul>
    <li><a href="#ID">ID</a>: Ruft die eindeutige ID eines Fensters ab.</li>
    <li><a href="#IDLast">IDLast</a>: Ruft die eindeutige ID des letzten/untersten Fensters bei mehr als einem Fund ab.</li>
    <li><a href="#PID">PID</a>: Ruft die Prozess-ID eines Fensters ab.</li>
    <li><a href="#ProcessName">ProcessName</a>: Ruft den Namen des Prozesses eines Fensters ab.</li>
    <li><a href="#ProcessPath">ProcessPath</a> <span class="ver">[v1.1.01+]</span>: Ruft den kompletten Pfad und Namen des Prozesses eines Fensters ab.</li>
    <li><a href="#Count">Count</a>: Ruft die Anzahl existierender Fenster gemäß den Titel/Text-Parametern ab.</li>
    <li><a href="#List">List</a>: Ruft die eindeutigen IDs aller existierenden Fenster gemäß den Titel/Text-Parametern ab.</li>
    <li><a href="#MinMax">MinMax</a>: Ruft eine Zahl ab, die angibt, ob ein Fenster minimiert oder maximiert ist.</li>
    <li><a href="#ControlList">ControlList</a>: Ruft die Namen aller Steuerelemente in einem Fenster ab.</li>
    <li><a href="#ControlListHwnd">ControlListHwnd</a> <span class="ver">[v1.0.43.06+]</span>: Ruft die eindeutigen IDs aller Steuerelemente in einem Fenster ab.</li>
    <li><a href="#Transparent">Transparent</a>: Ruft die Transparenzstärke eines Fensters ab.</li>
    <li><a href="#TransColor">TransColor</a>: Ruft die Farbe ab, die in einem Fenster als transparent markiert ist.</li>
    <li><a href="#Style">Style</a>: Ruft den Style eines Fensters als 8-stellige Hexadezimalzahl ab.</li>
    <li><a href="#ExStyle">ExStyle</a>: Ruft den erweiterten Style eines Fensters als 8-stellige Hexadezimalzahl ab.</li>
</ul>

<h3 id="ID">ID</h3>
<p>Ruft die eindeutige ID eines Fensters ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ID <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Auch bekannt als <a href="ControlGet.htm#Hwnd">Fensterhandle</a> (engl. window handle, kurz HWND). Wenn kein Fenster gefunden wurde, wird <em>AusgabeVar</em> leer gemacht. Die Funktionen <a href="WinExist.htm">WinExist()</a> und <a href="WinActive.htm">WinActive()</a> können auch verwendet werden, um die ID eines Fensters zu ermitteln. Zum Beispiel ist <code>WinExist("A")</code> ein schneller Weg, um die ID des aktiven Fensters zu erhalten. Mit <a href="ControlGet.htm#Hwnd">ControlGet Hwnd</a> oder <a href="MouseGetPos.htm">MouseGetPos</a> kann die HWND-Nummer eines Steuerelements abgerufen werden, um sie z.B. für <a href="PostMessage.htm">Post/SendMessage</a> oder <a href="DllCall.htm">DllCall</a> zu verwenden.</p>

<h3 id="IDLast">IDLast</h3>
<p>Ruft die eindeutige ID des letzten/untersten Fensters bei mehr als einem Fund ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, IDLast <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Auch bekannt als <a href="ControlGet.htm#Hwnd">Fensterhandle</a> (engl. window handle, kurz HWND). Wenn kein Fenster gefunden wurde, wird <em>AusgabeVar</em> leer gemacht. Wenn nur ein Fenster gefunden wurde, verhält sich dieser Unterbefehl wie der <a href="#ID">ID</a>- Unterbefehl. Dieses Konzept ähnelt dem von <a href="WinActivateBottom.htm">WinActivateBottom</a>.</p>

<h3 id="PID">PID</h3>
<p>Ruft die <a href="Process.htm">Prozess-ID-Nummer</a> eines Fensters ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, PID <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Wenn kein Fenster gefunden wurde, wird <em>AusgabeVar</em> leer gemacht.</p>

<h3 id="ProcessName">ProcessName</h3>
<p>Ruft den Namen des Prozesses eines Fensters ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ProcessName <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Zum Beispiel wäre das "notepad.exe". Wenn kein Fenster gefunden wurde, wird <em>AusgabeVar</em> leer gemacht.</p>

<h3 id="ProcessPath">ProcessPath <span class="ver">[v1.1.01+]</span></h3>
<p>Ruft den kompletten Pfad und Namen des Prozesses eines Fensters ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ProcessPath <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Zum Beispiel wäre das "C:\Windows\System32\notepad.exe". Wenn kein Fenster gefunden wurde, wird <em>AusgabeVar</em> leer gemacht.</p>

<h3 id="Count">Count</h3>
<p>Ruft die Anzahl existierender Fenster gemäß den Titel/Text-Parametern ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, Count <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Wenn kein Fenster gefunden wurde, wird <em>AusgabeVar</em> auf 0 gesetzt. Um alle Fenster im System zu zählen, lassen Sie alle vier Titel/Text-Parameter weg. Versteckte Fenster werden nur mitgezählt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist.</p>

<h3 id="List">List</h3>
<p>Ruft die eindeutigen IDs aller existierenden Fenster gemäß den Titel/Text-Parametern ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, List <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Um alle Fenster im System abzurufen, lassen Sie alle vier Titel/Text-Parameter weg. Jede ID-Nummer wird in eine Variable gespeichert, deren Name mit dem Namen von <em>AusgabeVar</em> beginnt (um ein <a href="../misc/Arrays.htm#pseudo">Pseudo-Array</a> zu formen). <em>AusgabeVar</em> selbst wird auf die Anzahl der abgerufenen IDs gesetzt (andernfalls 0). Wenn <em>AusgabeVar</em> z.B. MeinArray ist und wurden zwei Fenster gefunden, wird MeinArray1 auf die ID des ersten Fensters, MeinArray2 auf die ID des zweiten Fensters und MeinArray selbst auf 2 gesetzt. Die Fenster werden von oben nach unten abgerufen (entsprechend ihrer Stapelung auf dem Desktop). Versteckte Fenster werden nur mit einbezogen, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist. Um ein Pseudo-Array innerhalb einer <a href="../Functions.htm">Funktion</a> global statt lokal zu machen, <a href="../Functions.htm#Global">deklarieren</a> Sie MeinArray als globale Variable, bevor Sie diesen Befehl verwenden (für <a href="../Functions.htm#AssumeGlobal">Assume-Global</a>-Funktionen gilt das Gegenteil). Oft ist es auch notwendig, jede Variable in diesem Satz einzeln zu deklarieren, da ein <a href="../Functions.htm#ArrayConfusion">häufiger Anlass zu Verwirrung</a> vorliegt.</p>

<h3 id="MinMax">MinMax</h3>
<p>Ruft eine Zahl ab, die angibt, ob ein Fenster minimiert oder maximiert ist.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, MinMax <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p><em>AusgabeVar</em> wird leer gemacht, wenn kein Fenster gefunden wurde, andernfalls wird es auf eine der folgenden Zahlen gesetzt:</p>
<ul>
  <li>-1: Das Fenster ist minimiert (<a href="WinRestore.htm">WinRestore</a> kann es entminimieren).</li>
  <li>1: Das Fenster ist maximiert (<a href="WinRestore.htm">WinRestore</a> kann es entmaximieren).</li>
  <li>0: Das Fenster ist weder minimiert noch maximiert.</li>
</ul>

<h3 id="ControlList">ControlList</h3>
<p>Ruft die Namen aller Steuerelemente in einem Fenster ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ControlList <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Wenn kein Fenster gefunden wurde oder keine Steuerelemente im Fenster vorhanden sind, wird <em>AusgabeVar</em> leer gemacht. Andernfalls wird es auf eine Liste von Steuerelementnamen gesetzt. Jeder Name besteht aus dem Klassennamen des Steuerelements gefolgt von seiner Sequenznummer (ClassNN), wie im internen Tool "Window Spy" angezeigt.</p>
<p>Jeder Steuerelementname außer dem letzten endet mit einem LF-Zeichen (`n). Um die Steuerelementnamen einzeln durchzugehen, verwenden Sie eine <a href="LoopParse.htm">parsende Schleife</a>, wie in <a href="#ExControlList">Beispiel #3</a> unten gezeigt.</p>
<p>Steuerelemente werden nach ihrer Z-Reihenfolge sortiert, was üblicherweise der Navigation via <kbd>Tab</kbd> entspricht, sofern vom Fenster unterstützt.</p>

<h3 id="ControlListHwnd">ControlListHwnd <span class="ver">[v1.0.43.06+]</span></h3>
<p>Ruft die eindeutigen IDs aller Steuerelemente in einem Fenster ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ControlListHwnd <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Wenn kein Fenster gefunden wurde oder keine Steuerelemente im Fenster vorhanden sind, wird <em>AusgabeVar</em> leer gemacht. Andernfalls wird es auf eine Liste von eindeutigen IDs gesetzt. Jede ID ist das <a href="ControlGet.htm#Hwnd">Fensterhandle (HWND)</a> des Steuerelements.</p>
<p>Jede ID außer der letzten endet mit einem LF-Zeichen (`n). Um die IDs einzeln durchzugehen, verwenden Sie eine <a href="LoopParse.htm">parsende Schleife</a>, wie in <a href="#ExControlList">Beispiel #3</a> unten gezeigt.</p>
<p>Steuerelemente werden nach ihrer Z-Reihenfolge sortiert, was üblicherweise der Navigation via <kbd>Tab</kbd> entspricht, sofern vom Fenster unterstützt.</p>

<h3 id="Transparent">Transparent</h3>
<p>Ruft die Transparenzstärke eines Fensters ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, Transparent <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Mit <a href="WinSet.htm">WinSet</a> kann ein Fenster transparent gemacht werden. <em>AusgabeVar</em> wird leer gemacht, wenn: 1) das Betriebssystem älter als Windows XP ist; 2) kein Fenster gefunden wurde; 3) das Fenster nicht transparent ist; oder 4) andere Fälle auftreten (bedingt durch das Verhalten des Betriebssystems), z.B. wenn das transparent gemachte Fenster minimiert, wiederhergestellt und/oder größer/kleiner gemacht wurde. Andernfalls wird eine Zahl zwischen 0 und 255 gespeichert, wobei 0 ein durchsichtiges Fenster und 255 ein undurchsichtiges Fenster bedeutet. Zum Beispiel:</p>
<pre>MouseGetPos,,, MausFenster
WinGet, Transparenz, Transparent, ahk_id %MausFenster%  <em>; Transparenz des Fensters unter dem Mauszeiger.</em></pre>

<h3 id="TransColor">TransColor</h3>
<p>Ruft die Farbe ab, die in einem Fenster als transparent markiert ist.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, TransColor <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Mit <a href="WinSet.htm#TransColor">WinSet</a> kann eine Farbe als transparent markiert werden. <em>AusgabeVar</em> wird leer gemacht, wenn: 1) das Betriebssystem älter als Windows XP ist; 2) kein Fenster gefunden wurde; 3) das Fenster keine transparente Farbe hat; oder 4) andere Fälle auftreten (bedingt durch das Verhalten des Betriebssystems), z.B. wenn das transparent gemachte Fenster minimiert, wiederhergestellt und/oder größer/kleiner gemacht wurde. Andernfalls wird eine 6-stellige hexadezimale RGB-Farbe gespeichert, z.B. 0x00CC99. Zum Beispiel:</p>
<pre>MouseGetPos,,, MausFenster
WinGet, TransFarbe, TransColor, ahk_id %MausFenster%  <em>; Transparente Farbe des Fensters unter dem Mauszeiger.</em></pre>

<h3 id="Style">Style</h3>
<p>Ruft den Style eines Fensters als 8-stellige Hexadezimalzahl ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, Style <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Wenn kein Fenster gefunden wurde, wird <em>AusgabeVar</em> leer gemacht. Das folgende Beispiel prüft, ob ein Fenster den WS_DISABLED-Style hat:</p>
<pre>WinGet, Style, Style, Mein Fenstertitel
if (Style &amp; 0x8000000)  <em>; 0x8000000 ist WS_DISABLED.</em>
  MsgBox Das Fenster ist deaktiviert.</pre>
<p>Weitere Styles finden Sie unter <a href="../misc/Styles.htm">Fenster- und Steuerelement-Styles</a>.</p>

<h3 id="ExStyle">ExStyle</h3>
<p>Ruft den erweiterten Style eines Fensters als 8-stellige Hexadezimalzahl ab.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ExStyle <span class="optional">, FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span></pre>
<p>Wenn kein Fenster gefunden wurde, wird <em>AusgabeVar</em> leer gemacht. Das folgende Beispiel prüft, ob ein Fenster den WS_EX_TOPMOST-Style hat (immer im Vordergrund):</p>
<pre>WinGet, ExStyle, ExStyle, Mein Fenstertitel
if (ExStyle &amp; 0x8)  <em>; 0x8 ist WS_EX_TOPMOST.</em>
   MsgBox Das Fenster ist immer im Vordergrund.</pre>
<p>Weitere Styles finden Sie unter <a href="../misc/Styles.htm">Fenster- und Steuerelement-Styles</a>.</p>

<h2 id="Remarks">Bemerkungen</h2>
<p>Die Gültigkeit einer ID-Nummer ist an die Lebensdauer des zugehörigen Fensters gebunden. Mit anderen Worten: Wenn eine Anwendung neu gestartet wird, erhalten all ihre Fenster neue ID-Nummern.</p>
<p>Alle ID-Nummern, die mit diesem Befehl abgerufen werden, sind numerisch (ohne das Präfix "ahk_id") und werden im Hexadezimalformat gespeichert, egal welche <a href="SetFormat.htm">SetFormat</a>-Einstellung gerade aktiv ist.</p>
<p>Mit <a href="MouseGetPos.htm">MouseGetPos</a> kann die ID des Fensters unter dem Mauszeiger abgerufen werden.</p>
<p>Obwohl die ID-Nummern derzeit vorzeichenlose 32-Bit-Integer sind, können sie in einer zukünftigen Version 64-Bit sein. Daher ist es unsicher, numerische Operationen wie z.B. Additionen mit diesen Werten durchzuführen, da solche Operationen voraussetzen, dass die Eingabezeichenketten als vorzeichenfähige und nicht als vorzeichenlose Integer interpretierbar sind.</p>

<h2 id="Related">Siehe auch</h2>
<p><a href="WinGetClass.htm">WinGetClass</a>, <a href="Process.htm">Process</a>, <a href="WinGetTitle.htm">WinGetTitle</a>, <a href="MouseGetPos.htm">MouseGetPos</a>, <a href="ControlGet.htm">ControlGet</a>, <a href="ControlFocus.htm">ControlFocus</a>, <a href="GroupAdd.htm">GroupAdd</a></p>

<h2 id="Examples">Beispiele</h2>

<div class="ex" id="ExID">
<p><a class="ex_number" href="#ExID"></a> Maximiert das aktive Fenster und meldet dessen eindeutige ID.</p>
<pre>WinGet, AktiveID, ID, A
WinMaximize, ahk_id %AktivID%
MsgBox, Die ID des aktiven Fensters ist "%AktiveID%".</pre>
</div>

<div class="ex" id="ExList">
<p><a class="ex_number" href="#ExList"></a> Besucht alle Fenster im System und zeigt Informationen zu jedem an.</p>
<pre>WinGet, id, List,,, Program Manager
Loop, %id%
{
    diese_ID := id%A_Index%
    WinActivate, ahk_id %diese_ID%
    WinGetClass, diese_Klasse, ahk_id %diese_ID%
    WinGetTitle, dieser_Titel, ahk_id %diese_ID%
    MsgBox, 4, , Gehe alle Fenster durch`n%A_Index% von %id%`nahk_id %diese_ID%`nahk_class %diese_Klasse%`n%dieser_Titel%`n`nWeiter?
    IfMsgBox, NO, break
}</pre>
</div>

<div class="ex" id="ExControlList">
<p><a class="ex_number" href="#ExControlList"></a> Extrahiert die einzelnen Steuerelementnamen aus der Steuerelementliste des aktiven Fensters.</p>
<pre>WinGet, StrlmntListe, ControlList, A
Loop, Parse, StrlmntListe, `n
{
    MsgBox, 4,, Steuerelement Nr. %A_Index% ist "%A_LoopField%". Weiter?
    IfMsgBox, No
        break
}</pre>
</div>

<div class="ex" id="ExRealTime">
<p><a class="ex_number" href="#ExRealTime"></a> Zeigt in Echtzeit die Steuerelementliste des aktiven Fensters an.</p>
<pre>#Persistent
SetTimer, AktivesFensterBeobachten, 200
return

AktivesFensterBeobachten:
WinGet, StrlmntListe, ControlList, A
ToolTip, %StrlmntListe%
return</pre>
</div>

</body>
</html>
