<!DOCTYPE HTML>
<html lang="de">
<head>
<title>MsgBox - Syntax &amp; Verwendung | AutoHotkey</title>
<meta name="description" content="Der MsgBox-Befehl zeigt einen bestimmten Text in einem kleinen Fenster an, das eine oder mehrere Schaltflächen enthält (z. B. Ja und Nein)." />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga4.js" type="text/javascript"></script>
</head>
<body>

<h1>MsgBox</h1>

<p>Zeigt einen bestimmten Text in einem kleinen Fenster an, das eine oder mehrere Schaltflächen enthält (z. B. Ja und Nein).</p>

<pre class="Syntax">
<span class="func">MsgBox</span>, Text
<span class="func">MsgBox</span> <span class="optional">, Optionen, Titel, Text, Zeitlimit</span>
</pre>
<h2 id="Parameters">Parameter</h2>
<dl>

  <dt>Text</dt>
  <dd><p>Lässt man alle Parameter weg, wird das Mitteilungsfenster "Press OK to continue." anzeigen. Ansonsten ist dieser Parameter der Text, der im Mitteilungsfenster angezeigt werden soll, um den Benutzer zu sagen, was zu tun ist, oder um Informationen zu präsentieren.</p>
    <p>Mit <a href="../misc/EscapeChar.htm">Escapesequenzen</a> können spezielle Zeichen dargestellt werden. Zum Beispiel wäre `n ein Zeilenumbruchszeichen, das die aktuelle Zeile beendet und eine neue beginnt. Demzufolge würde Text1`n`nText2 eine leere Zeile zwischen Text1 und Text2 erzeugen.</p>
    <p>Wenn der <em>Text</em> relativ lang ist, kann er via <a href="../Scripts.htm#continuation">Fortsetzungsbereich</a> in mehreren kurzen Zeilen aufgeteilt werden, um die Übersichtlichkeit und Wartbarkeit des Skripts zu erhöhen.</p></dd>

  <dt>Optionen</dt>
  <dd><p>Kennzeichnet den Typ des Mitteilungsfensters und die möglichen Schaltflächenkombinationen. Wenn dieser Parameter weggelassen wird oder leer ist, wird standardmäßig 0 verwendet. Die zulässigen Werte finden Sie in den folgenden Tabellen.</p>
    <p>Dieser Parameter muss entweder eine direkt geschriebene Zahl oder <span class="ver">[in v1.1.06+]</span> ein erzwungener Ausdruck wie <code>% Optionen</code> sein. Jeder andere nicht-leere Wert bewirkt, dass der Einzelparametermodus in Kraft tritt und dieser Wert stattdessen als Teil des <em>Text</em>-Parameters erkannt wird.</p></dd>

  <dt>Titel</dt>
  <dd><p>Der Titel des Mitteilungsfensters. Wenn dieser Parameter weggelassen wird oder leer ist, wird standardmäßig der Name des Skripts (ohne Pfad) verwendet.</p></dd>

  <dt id="Timeout">Zeitlimit</dt>
  <dd><p>(Optional) Zeitlimit in Sekunden, der einen Dezimalpunkt enthalten kann, aber standardmäßig kein Ausdruck ist. <span class="ver">[v1.1.06+]</span>: Dieser Parameter kann ein erzwungener Ausdruck wie <code>% mins*60</code> sein.</p>
    <p>Wenn ein Zeitlimit höher als 2147483 (24,8 Tage) angegeben ist, wird es automatisch auf 2147483 zurückgesetzt. Nach Ablauf des Zeitlimits wird das Mitteilungsfenster automatisch geschlossen und für <a href="IfMsgBox.htm">IfMsgBox</a> der Wert TIMEOUT gesetzt.</p>
    <p>Die folgende Einschränkung wurde in <span class="ver">[v1.1.30.01]</span> beseitigt: Bei einem Mitteilungsfenster, das nur eine OK-Schaltfläche enthält, wird <a href="IfMsgBox.htm">IfMsgBox</a> denken, dass die OK-Schaltfläche gedrückt wurde, wenn das Mitteilungsfenster das Zeitlimit überschreitet, während ihr eigener <a href="../misc/Threads.htm">Thread</a> von einem anderen Thread unterbrochen wird.</p></dd>

</dl>

<h2 id="Options">Werte für den <em>Optionen</em>-Parameter</h2>
<p>Der <em>Optionen</em>-Parameter kann eine Kombination (Summe) von Werten aus den folgenden Gruppen sein.</p>
<h3 id="Group_1_Buttons">Gruppe #1: Schaltflächen</h3>
<p>Um zu bestimmen, welche Schaltflächen im Mitteilungsfenster angezeigt werden sollen, addieren Sie <strong>einen</strong> der folgenden Werte:</p>
<table class="info">
  <tr>
    <th style="width:287px">Funktion</th>
    <th abbr="Dez">Dezimal-Wert</th>
    <th abbr="Hex">Hex-Wert</th>
  </tr>
  <tr>
    <td>OK</td>
    <td>0</td>
    <td>0x0</td>
  </tr>
  <tr>
    <td>OK / Abbrechen</td>
    <td>1</td>
    <td>0x1</td>
  </tr>
  <tr>
    <td>Abbrechen / Wiederholen / Ignorieren</td>
    <td>2</td>
    <td>0x2</td>
  </tr>
  <tr>
    <td>Ja / Nein / Abbrechen</td>
    <td>3</td>
    <td>0x3</td>
  </tr>
  <tr>
    <td>Ja / Nein</td>
    <td>4</td>
    <td>0x4</td>
  </tr>
  <tr>
    <td>Wiederholen / Abbrechen</td>
    <td>5</td>
    <td>0x5</td>
  </tr>
  <tr>
    <td>Abbrechen / Wiederholen / Weiter</td>
    <td>6</td>
    <td>0x6</td>
  </tr>
  </table>
<h3 id="Group_2_Icon">Gruppe #2: Icon</h3>
<p>Um ein Symbol im Mitteilungsfenster darzustellen, addieren Sie <strong>einen</strong> der folgenden Werte:</p>
<table class="info">
  <tr>
    <th style="width:287px">Funktion</th>
    <th abbr="Dez">Dezimal-Wert</th>
    <th abbr="Hex">Hex-Wert</th>
  </tr>
  <tr>
    <td>Handsymbol (Stopp / Fehler)</td>
    <td>16</td>
    <td>0x10</td>
  </tr>
  <tr>
    <td>Fragezeichensymbol</td>
    <td>32</td>
    <td>0x20</td>
  </tr>
  <tr>
    <td>Ausrufezeichensymbol</td>
    <td>48</td>
    <td>0x30</td>
  </tr>
  <tr>
    <td>Sternchensymbol (Info)</td>
    <td>64</td>
    <td>0x40</td>
  </tr>
  </table>
<h3 id="Group_3_Default_Button">Gruppe #3: Standard-Schaltfläche</h3>
<p>Um die Standardschaltfläche zu bestimmen, addieren Sie <strong>einen</strong> der folgenden Werte:</p>
<table class="info">
  <tr>
    <th style="width:287px">Funktion</th>
    <th abbr="Dez">Dezimal-Wert</th>
    <th abbr="Hex">Hex-Wert</th>
  </tr>
  <tr>
    <td>Macht die zweite Schaltfläche zur Standard-Schaltfläche</td>
    <td>256</td>
    <td>0x100</td>
  </tr>
  <tr>
    <td>Macht die dritte Schaltfläche zur Standard-Schaltfläche</td>
    <td>512</td>
    <td>0x200</td>
  </tr>
  <tr>
    <td>Macht die vierte Schaltfläche zur Standard-Schaltfläche<br>(erfordert die Hilfe-Schaltfläche)</td>
    <td>768</td>
    <td>0x300</td>
  </tr>
  </table>
<h3 id="Group_4_Modality">Gruppe #4: Modalität</h3>
<p>Um die Modalität des Dialogfensters zu bestimmen, addieren Sie <strong>einen</strong> der folgenden Werte:</p>
<table class="info">
  <tr>
    <th style="width:287px">Funktion</th>
    <th abbr="Dez">Dezimal-Wert</th>
    <th abbr="Hex">Hex-Wert</th>
  </tr>
  <tr>
    <td>System-Modal (immer im Vordergrund)</td>
    <td>4096</td>
    <td>0x1000</td>
  </tr>
  <tr>
    <td>Task-Modal</td>
    <td>8192</td>
    <td>0x2000</td>
  </tr>
  <tr>
    <td>Immer im Vordergrund (WS_EX_TOPMOST-Style)<br>
      (ähnlich wie System Modal, aber ohne Titelleistensymbol)</td>
    <td>262144</td>
    <td>0x40000</td>
  </tr>
  </table>
<h3 id="Group_5_Other_Options">Gruppe #5: Sonstige Optionen</h3>
<p>Um sonstige Optionen anzugeben, addieren Sie <strong>einen oder mehrere</strong> der folgenden Werte:</p>
<table class="info">
  <tr>
    <th style="width:287px">Funktion</th>
    <th abbr="Dez">Dezimal-Wert</th>
    <th abbr="Hex">Hex-Wert</th>
  </tr>
  <tr>
    <td>Fügt eine Hilfe-Schaltfläche hinzu (siehe Bemerkungen)</td>
    <td>16384</td>
    <td>0x4000</td>
  </tr>
  <tr>
    <td>Macht den Text rechtsbündig</td>
    <td>524288</td>
    <td>0x80000</td>
  </tr>
  <tr>
    <td>Rechts-nach-Links-Leselayout für Hebräisch / Arabisch</td>
    <td>1048576</td>
    <td>0x100000</td>
  </tr>
</table>
<h2 id="Remarks">Bemerkungen</h2>
<p>Ein typisches Mitteilungsfenster sieht wie folgt aus:</p>
<img src="../static/dlg_message.png" alt="MsgBox" />
<p>Die Werte in den oberen Tabellen können addiert werden, um Eigenschaften zu kombinieren, die beim Mitteilungsfenster vorhanden sein sollen. Wenn Sie beispielsweise ein Ja/Nein-Mitteilungsfenster haben wollen, dessen Standard-Schaltfläche Nein statt Ja ist, müssen Sie in den <em>Optionen</em> den Wert 256+4 (260) angeben. Hexadezimal ausgedrückt wäre das 0x100+0x4 (0x104).</p>
<p>MsgBox hat eine intelligente Komma-Handhabung - das heißt, dass Kommas im <em>Text</em>-Parameter nicht mit einem <a href="../misc/EscapeChar.htm">Escapezeichen</a> versehen werden müssen.</p>
<p>Der <a href="IfMsgBox.htm">IfMsgBox</a>-Befehl kann genutzt werden, um festzustellen, welche MsgBox-Schaltfläche der Benutzer zuletzt gedrückt hat. Zum Beispiel:</p>
<pre>MsgBox, 4,, Möchten Sie fortfahren? (drücken Sie Ja oder Nein)
IfMsgBox Yes
    MsgBox Sie haben Ja gedrückt.
else
    MsgBox Sie haben Nein gedrückt.</pre>
<p>Um die Namen der Schaltflächen individuell anzupassen, ist <a href="../scripts/index.htm#MsgBoxButtonNames">dieses Beispiel</a> hilfreich.</p>
<p><strong>Tipp</strong>: Sie können <kbd>Strg</kbd>+<kbd>C</kbd> in einem aktiven Mitteilungsfenster drücken, um dessen Text in die Zwischenablage zu kopieren. Diese Methode kann auch bei Mitteilungsfenstern angewendet werden, die nicht mit AutoHotkey erstellt wurden.</p>
<p><strong>MsgBox mit einem GUI-Fenster verwenden</strong>: Ein GUI-Fenster kann ein <em>modales</em> Mitteilungsfenster mithilfe von <a href="Gui.htm#OwnDialogs">Gui +OwnDialogs</a> darstellen. Ein <em>modales</em> Mitteilungsfenster hindert den Benutzer daran, mit dem GUI-Fenster zu interagieren, bis er das Mitteilungsfenster wieder schließt. In so einem Fall können die Optionen System-Modal oder Task-Modal weggelassen werden.</p>
<p>Wenn <a href="Gui.htm#OwnDialogs">Gui +OwnDialogs</a> <em>nicht</em> aktiv ist, kann die Task-Modal-Option (8192) genutzt werden, um die Interaktion mit allen Skriptfenstern zu deaktivieren, bis der Benutzer das Mitteilungsfenster schließt.</p>
<p><strong>Die Hilfe-Schaltfläche</strong>: Wenn die Hilfe-Schaltfläche-Option (16384) in <em>Optionen</em> vorhanden ist, wird die Hilfe-Schaltfläche nur unter folgenden Bedingungen funktionieren:</p>
<ol>
  <li>Das Mitteilungsfenster wurde einem GUI-Fenster mithilfe von <a href="Gui.htm#OwnDialogs">Gui +OwnDialogs</a> untergeordnet.</li>
  <li>Das Skript überwacht die WM_HELP-Meldung (0x0053). Zum Beispiel: <code><a href="OnMessage.htm">OnMessage</a>(0x0053, "WM_HELP")</code>. Diese Anweisung bewirkt, dass, sobald der Benutzer die Hilfe-Schaltfläche drückt, die WM_HELP-Funktion aufgerufen wird. Diese Funktion könnte zum Beispiel ein anderes GUI-Fenster oder Mitteilungsfenster anzeigen, um den Benutzer Instruktionen mitzuteilen.</li>
</ol>
<p><strong>Die Schließen-Schaltfläche (in der Titelleiste des Mitteilungsfensters)</strong>: Aufgrund der Tatsache, dass das Mitteilungsfenster intern vom Betriebssystem kontrolliert wird, sind die Verfügbarkeit und das Verhalten der <strong>X</strong>-Schaltfläche abhängig davon, welche Schaltflächen vorhanden sind. Wenn nur die OK-Schaltfläche vorhanden ist, wäre das Drücken von <strong>X</strong> das gleiche wie, als hätte man OK gedrückt. Ansonsten ist die X-Schaltfläche deaktiviert, es sei denn, die Abbrechen-Schaltfläche ist vorhanden, dann wäre das Drücken von <strong>X</strong> das gleiche wie, als hätte man Abbrechen gedrückt.</p>
<h2 id="Related">Siehe auch</h2>
<p><a href="IfMsgBox.htm">IfMsgBox</a>, <a href="InputBox.htm">InputBox</a>, <a href="FileSelectFile.htm">FileSelectFile</a>, <a href="FileSelectFolder.htm">FileSelectFolder</a>, <a href="ToolTip.htm">ToolTip</a>, <a href="Gui.htm">GUI</a></p>
<h2 id="Examples">Beispiele</h2>
<div class="ex" id="ExOneParam">
<p><a class="ex_number" href="#ExOneParam"></a> Der Einzelparametermodus. Eine schnelle und einfache Möglichkeit, Informationen anzuzeigen. Der Benutzer kann eine OK-Schaltfläche drücken, um das Mitteilungsfenster zu schließen und die Ausführung fortzusetzen.</p>
<pre>MsgBox Das ist der Einzelparametermodus. Kommas (,) müssen nicht mit einem Escapezeichen versehen werden.</pre>
</div>

<div class="ex" id="ExThreeParam">
<p><a class="ex_number" href="#ExThreeParam"></a> Der Dreiparametermodus. Verwenden Sie den ersten und zweiten Parameter, um die Optionen und den Titel anzugeben.</p>
<pre>MsgBox, 4, , Das ist der Dreiparametermodus. Kommas (,) müssen nicht mit einem Escapezeichen versehen werden.</pre>
</div>

<div class="ex" id="ExIfMsgBox">
<p><a class="ex_number" href="#ExIfMsgBox"></a> Verwenden Sie <a href="IfMsgBox.htm">IfMsgBox</a>, um festzustellen, welche MsgBox-Schaltfläche der Benutzer zuletzt gedrückt hat.</p>
<pre>MsgBox, 4, , Möchten Sie fortfahren? (Drücken Sie JA oder NEIN)
IfMsgBox No
    return</pre>
</div>

<div class="ex" id="ExTimeout">
<p><a class="ex_number" href="#ExTimeout"></a> Der Vierparametermodus. Verwenden Sie den vierten Parameter (Zeitlimit), um das Mitteilungsfenster nach einer bestimmten Anzahl von Sekunden automatisch zu schließen.</p>
<pre>MsgBox, 4, , Vierparametermodus: Diese MsgBox wird in 5 Sekunden automatisch geschlossen.  Weiter?, 5
IfMsgBox Timeout
    MsgBox Sie haben innerhalb von 5 Sekunden weder JA noch NEIN gedrückt.
else IfMsgBox No
    return</pre>
</div>

<div class="ex" id="ExExpression">
<p><a class="ex_number" href="#ExExpression"></a> Durch Voranstellen von <code>% </code> wird jeder Parameter zu einem <a href="../Variables.htm#Expressions">Ausdruck</a>. Das folgende Beispiel zeigt, wie eine Berechnung durchgeführt, auf ein <a href="../misc/Arrays.htm#pseudo">Pseudo-Array</a>-Element zugegriffen und eine Funktion aufgerufen werden kann. All diese Elemente werden mit dem Punkt-Operator verbunden, um eine einzelne Zeichenkette via MsgBox anzuzeigen.</p>
<pre>MsgBox % "Die neue Breite des Objekts #" . A_Index . " ist: " . BreiteBegrenzen(ObjektBreite%A_Index% * SkalierungFaktor)</pre>
</div>

<div class="ex" id="ExFocus">
<p><a class="ex_number" href="#ExFocus"></a> Warnt den Benutzer, dass der Fokus gleich von einem Mitteilungsfenster beansprucht wird (falls der Benutzer gerade etwas schreibt).</p>
<pre>SplashTextOn,,, Es erscheint gleich ein Mitteilungsfenster.
Sleep 3000
SplashTextOff
MsgBox Der Sicherungsprozess wurde abgeschlossen.</pre>
</div>

</body>
</html>
